#include <cstdint>
#include <cstdlib>

namespace AE32_144_detail {
static const uint32_t arr[144] = {
    4261780, 161131,  25008,   1635990, 464504,  712241,   1247844, 2269730,  67925,   1096405,  4246806,  58295,
    4895692, 1393591, 304392,  1934440, 10468,   78969,    2243928, 2070349,  247225,  53579,    949498,   23316,
    8594309, 5301474, 1097669, 474253,  260305,  1053150,  3966026, 1652540,  36155,   126941,   3130097,  2332285,
    287415,  111724,  2057282, 214715,  628910,  3217239,  36785,   629305,   191956,  1475964,  645791,   1447232,
    48884,   4104006, 1767827, 13559,   37835,   1824059,  1614719, 94791,    358285,  1583891,  1886098,  632863,
    147211,  225695,  1167213, 65862,   2055185, 4170234,  1273865, 247959,   2087488, 3936,     511072,   904229,
    67907,   2622657, 3500781, 5883656, 80637,   13700572, 1242432, 185139,   1480732, 898022,   26559679, 2299107,
    179952,  629095,  351970,  852536,  204880,  1896923,  964903,  71164,    9462006, 511865,   406816,   67020,
    131237,  4512980, 30956,   1110308, 476682,  222683,   7622773, 3638293,  637432,  12228485, 187440,   1582805,
    80273,   1969846, 3114919, 1010772, 257538,  120534,   1754075, 1925335,  1899220, 777009,   145797,   266,
    44545,   9329681, 85963,   395743,  380468,  16502214, 474048,  445723,   129962,  5141700,  447083,   1664265,
    1437943, 110136,  188672,  810327,  992161,  4867373,  13963,   64126753, 519107,  526258,   1744010,  1085288};

uint16_t hash( uint32_t n ) {
  long long t = n;
  t = ( ( t >> 16 ) ^ t ) * 0xda2e4f1;
  return t % 144;
}

bool is_SPRP( uint32_t n, uint32_t a ) {
  uint32_t d = n - 1;
  uint32_t s = __builtin_ctz( d );
  d >>= s;
  uint64_t cur = 1;
  uint64_t pw = d;
  while( pw ) {
    if( pw & 1 ) {
      cur = ( cur * a ) % n;
    }
    a = ( ( uint64_t ) a * a ) % n;
    pw >>= 1;
  }
  if( cur == 1 ) {
    return true;
  }
  for( uint32_t r = 0; r < s; r++ ) {
    if( cur == n - 1 ) {
      return true;
    }
    cur = ( cur * cur ) % n;
  }
  return false;
}
} // namespace AE32_144_detail

bool AE32_144( uint32_t n ) {
  if( n < 11 ) {
    return ( n == 2 || n == 3 || n == 5 || n == 7 ) ? true : false;
  }
  if( !( n % 2 ) || !( n % 3 ) || !( n % 5 ) || !( n % 7 ) ) {
    return false;
  }
  if( n < 121 ) {
    return true;
  }
  if( !( n % 11 ) || !( n % 13 ) || !( n % 17 ) || !( n % 19 ) || !( n % 23 ) ) {
    return false;
  }
  if( n < 841 ) {
    return true;
  }
  uint16_t h = AE32_144_detail::hash( n );
  uint32_t base = AE32_144_detail::arr[h];
  return AE32_144_detail::is_SPRP( n, base );
}
/*
#include <cstdio>

int main(){
        uint32_t result = 0;
  for( uint32_t i = 0; i < 10000000; ++i){
          if( AE32_144( i ) ) {
                  ++ result;
  }
  }
  printf("%d\n", result);
}
*/
