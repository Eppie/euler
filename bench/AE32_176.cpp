#include <cstdint>
#include <cstdlib>

namespace AE32_176_detail {
static const uint32_t arr[176] = {
    42942,  151391, 83927,  207320, 13183,  58189,  74720, 21739,  3932,   8891,   10496, 373591, 45809, 5517,
    7732,   21068,  93691,  86229,  186085, 453779, 73199, 15776,  39460,  45132,  18159, 95958,  2603,  89586,
    57274,  25175,  22821,  29125,  41212,  165087, 45166, 10674,  2297,   75188,  61032, 9569,   94790, 362863,
    3725,   9948,   83053,  130646, 26747,  42314,  16614, 517852, 178475, 13415,  17518, 16723,  18348, 24342,
    100759, 320824, 16246,  22223,  72872,  19884,  11702, 6277,   92501,  2416,   20432, 97889,  31476, 25544,
    19719,  12280,  112652, 105456, 11688,  2204,   33657, 11061,  169704, 2380,   23894, 186854, 20826, 100729,
    713,    31448,  150263, 25794,  21859,  172625, 15066, 11277,  9565,   88025,  60945, 50302,  13092, 84589,
    1210,   3406,   195080, 91934,  9050,   6027,   36689, 25597,  64748,  385327, 1353,  7974,   21551, 10398,
    6574,   45610,  1784,   30600,  22904,  79916,  88,    15469,  5323,   36297,  68846, 615,    1929,  14775,
    65791,  63098,  188761, 65320,  179093, 9332,   43875, 60688,  15651,  113585, 12122, 19174,  82196, 153534,
    8479,   33413,  77179,  19382,  510,    6872,   2110,  120205, 7352,   270187, 47316, 83388,  14232, 8569,
    11852,  136491, 755371, 5053,   108455, 11160,  35134, 23477,  53527,  105915, 62028, 233968, 49474, 7746,
    52579,  5629,   1029,   212460, 1055,   175978, 7533,  69246};

uint16_t hash( uint32_t n ) {
  long long t = n;
  t = ( ( t >> 16 ) ^ t ) * 0xda2e4f1;
  return t % 176;
}

bool is_SPRP( uint32_t n, uint32_t a ) {
  uint32_t d = n - 1;
  uint32_t s = __builtin_ctz( d );
  d >>= s;
  uint64_t cur = 1;
  uint64_t pw = d;
  while( pw ) {
    if( pw & 1 ) {
      cur = ( cur * a ) % n;
    }
    a = ( ( uint64_t ) a * a ) % n;
    pw >>= 1;
  }
  if( cur == 1 ) {
    return true;
  }
  for( uint32_t r = 0; r < s; r++ ) {
    if( cur == n - 1 ) {
      return true;
    }
    cur = ( cur * cur ) % n;
  }
  return false;
}
} // namespace AE32_176_detail

bool AE32_176( uint32_t n ) {
  if( n < 11 ) {
    return ( n == 2 || n == 3 || n == 5 || n == 7 ) ? true : false;
  }
  if( !( n % 2 ) || !( n % 3 ) || !( n % 5 ) || !( n % 7 ) ) {
    return false;
  }
  if( n < 121 ) {
    return true;
  }
  if( !( n % 11 ) || !( n % 13 ) || !( n % 17 ) || !( n % 19 ) || !( n % 23 ) || !( n % 29 ) || !( n % 31 )
      || !( n % 37 ) || !( n % 41 ) || !( n % 43 ) || !( n % 47 ) || !( n % 53 ) ) {
    return false;
  }
  if( n < 3481 ) {
    return true;
  }
  uint16_t h = AE32_176_detail::hash( n );
  uint32_t base = AE32_176_detail::arr[h];
  return AE32_176_detail::is_SPRP( n, base );
}
/*
#include <cstdio>

int main(){
        uint32_t result = 0;
  for( uint32_t i = 0; i < 10000000; ++i){
          if( AE32_176( i ) ) {
                  ++ result;
  }
  }
  printf("%d\n", result);
}
*/
