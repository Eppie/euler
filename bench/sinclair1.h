#include <cstdlib>
#include <gmp.h>

namespace sinclair {
typedef unsigned long long int ullint;

int hashSize = 2048;
int mask = 2047;
ullint multiplier = 3141592653589793239L;

int SPRPlookup[2048] = {
    4507,   855,    42622,  1491,   4347,   4663,   4086,   4919,   2822,   2822,   9863,   23675,  8314,    9161,
    7859,   37462,  21997,  63233,  8531,   3398,   37853,  24647,  2489,   902,    7631,   9891,   6601,    1983,
    5801,   2099,   2253,   1797,   13761,  44657,  93,     2351,   406,    3725,   4190,   81977,  10730,   1693,
    13822,  91,     2765,   2385,   1575,   683,    3901,   40271,  10215,  5977,   3347,   132646, 90015,   4989,
    1717,   2429,   8589,   2167,   1047,   1447,   14043,  9986,   16094,  78742,  2069,   1157,   3517,    1298,
    12778,  635,    1534,   11715,  1583,   33263,  4279,   2491,   49477,  80041,  15739,  155,    4542,    2793,
    290,    7399,   447,    1054,   51205,  1661,   114,    7097,   3085,   7349,   5562,   4885,   40298,   22577,
    27745,  12396,  12049,  3953,   24419,  349,    3057,   33,     24907,  1385,   3899,   8777,   3201,    28249,
    115,    2202,   7913,   1714,   68213,  12825,  4707,   1307,   6805,   52262,  1514,   3395,   2737,    1791,
    3763,   238,    4178,   465,    6565,   2705,   6607,   25499,  1642,   466,    25926,  513,    211,     6817,
    2814,   185,    7201,   1778,   2521,   767,    1663,   9071,   107881, 24549,  21757,  2314,   7342,    5238,
    4789,   963,    18561,  2286,   8103,   29093,  6523,   9881,   510,    327,    75506,  227,    297,     5706,
    2210,   5835,   5291,   221,    8657,   4139,   10138,  6793,   9521,   2389,   12897,  8195,   14133,   24086,
    925,    9863,   1038,   4917,   3550,   46738,  55,     7678,   57251,  1642,   37,     9601,   1807,    32655,
    8769,   47766,  247,    2259,   2674,   867,    3833,   270,    193,    7714,   24078,  1779,   4177,    535,
    14595,  2314,   8583,   1830,   8515,   30697,  19562,  6317,   15875,  5137,   2059,   3369,   421,     2089,
    1750,   3569,   12773,  11531,  5185,   5961,   3305,   54139,  11635,  3726,   19679,  5623,   1877,    629,
    5375,   5073,   747,    5879,   4475,   8381,   9029,   1461,   2205,   6114,   2163,   116663, 25631,   32853,
    5217,   2319,   11243,  485,    36193,  382,    2353,   1747,   5773,   707,    78910,  10703,  11397,   3275,
    335,    2054,   771,    1115,   44046,  7503,   6703,   105093, 3315,   3589,   15435,  3985,   1045,    5617,
    5541,   63,     9386,   749,    661,    11809,  140615, 1229,   20030,  2431,   3175,   12441,  12229,   591,
    5393,   37061,  1978,   5515,   3831,   671,    10599,  9143,   17718,  2139,   1741,   1707,   19115,   1887,
    16082,  525,    1643,   9773,   1385,   71734,  2545,   69,     16839,  4227,   17737,  2971,   511,     10526,
    12367,  1839,   44677,  1090,   18955,  646,    8317,   4597,   889,    3565,   2925,   5165,   29673,   4461,
    7465,   1123,   8650,   5746,   7003,   2267,   342,    835,    965,    4247,   3031,   18695,  1294,    58719,
    1739,   25481,  1714,   214,    4875,   10898,  7687,   2291,   14207,  2942,   1247,   2710,   563,     4025,
    498,    2331,   32070,  14386,  14035,  4007,   2039,   5147,   31929,  66033,  5914,   41649,  12253,   6497,
    6203,   2607,   1991,   2701,   3403,   12726,  663,    3358,   3482,   5366,   1743,   224573, 4083,    16134,
    166147, 1021,   36902,  150306, 16426,  79,     1631,   45126,  9734,   7183,   15107,  39105,  1395,    5838,
    136174, 10719,  43366,  326,    12925,  6478,   3702,   2642,   4811,   1665,   12559,  6006,   14485,   21833,
    923,    971,    8014,   9743,   11965,  511,    3987,   1046,   4417,   5239,   6779,   41516,  2459,    13002,
    1351,   3206,   18898,  446,    938,    28439,  1306,   3922,   12965,  26431,  26421,  26362,  1483,    4547,
    1239,   1665,   5914,   295,    1035,   2570,   9663,   16107,  19206,  6279,   745,    2162,   2137,    2267,
    4497,   12615,  303,    43461,  12382,  8330,   551,    4973,   3129,   32165,  1653,   843,    763,     1778,
    3594,   1141,   381,    29405,  3117,   34778,  2481,   6547,   30571,  3283,   1578,   21550,  850,     18179,
    2133,   29,     7178,   267,    12342,  8102,   1650,   10183,  1191,   4966,   1759,   4155,   166,     2787,
    1355,   285,    28401,  3737,   1993,   12607,  1938,   1767,   33049,  3954,   23562,  4223,   18645,   9889,
    1848,   866,    3047,   1047,   277,    12902,  2293,   2775,   16311,  44598,  7211,   64269,  8383,    12815,
    52482,  521,    19531,  205,    93,     37519,  1599,   12446,  642,    7733,   467,    951,    5481,    127,
    3973,   7078,   6925,   9754,   718,    6901,   2134,   53925,  13010,  2607,   10941,  3106,   3451,    1815,
    16998,  2582,   22067,  546,    527,    245,    835,    39121,  217,    1518,   49826,  311,    7841,    16041,
    4345,   2678,   22746,  6066,   265,    214429, 9706,   790,    23915,  789,    12225,  2678,   445,     6193,
    221,    2393,   9666,   559,    1019,   8767,   16387,  7458,   565,    1803,   1925,   638,    7171,    5225,
    2725,   2875,   493,    17370,  1391,   16083,  42345,  3047,   10107,  175,    3461,   22859,  17526,   76521,
    5849,   11977,  6117,   2093,   67,     21586,  8683,   3917,   14497,  8889,   29334,  26847,  9787,    10093,
    7741,   5505,   1487,   3179,   801,    1871,   4585,   1878,   32467,  1374,   4301,   8035,   83047,   11897,
    51731,  1623,   8619,   3651,   1641,   8926,   842,    10798,  21098,  26605,  50567,  8959,   3146,    577,
    3217,   11089,  4254,   945,    5877,   1946,   1862,   105549, 6402,   5129,   999,    43170,  36246,   2154,
    397,    7135,   1193,   4579,   849,    22467,  5469,   1713,   419,    466,    883,    11922,  10013,   2083,
    2919,   191135, 16919,  2857,   2215,   1227,   13441,  32022,  12087,  4055,   4786,   1579,   4982,    272537,
    2803,   4646,   76158,  4691,   19163,  4289,   4003,   975,    59682,  3729,   185115, 21630,  50521,   29373,
    19418,  1683,   4486,   5887,   1829,   4915,   5950,   1461,   4894,   19303,  10221,  26725,  4071,    5282,
    91,     33837,  10825,  46909,  1541,   702,    2247,   7899,   4241,   20175,  45005,  4326,   2038,    681,
    1285,   513,    6090,   362,    195,    1695,   39841,  15,     2706,   695,    637,    9209,   2418,    2355,
    26325,  12510,  5741,   19267,  129,    25511,  5919,   11441,  4890,   15459,  4635,   15357,  16287,   6023,
    10478,  112122, 1906,   135,    12925,  2119,   327,    5019,   6818,   1953,   51226,  4938,   3714,    2266,
    858,    2174,   22291,  30865,  8769,   1817,   5290,   2866,   1657,   3349,   9381,   26987,  78,      12554,
    661,    1086,   25125,  2195,   4330,   81486,  7943,   7489,   18509,  930,    27291,  1607,   20219,   1483,
    20671,  13331,  5590,   18615,  7162,   5873,   3641,   9022,   2651,   241,    7169,   1789,   110,     4737,
    42655,  20751,  9411,   13033,  11210,  4350,   7326,   1049,   4662,   1334,   10578,  4233,   1021,    10935,
    2239,   747,    6217,   21526,  23606,  3434,   3057,   4771,   2532,   1858,   857,    26989,  1490,    3605,
    3739,   3965,   506,    2766,   3775,   919,    59551,  4151,   12139,  3177,   1613,   135,    5602,    5964,
    39458,  590,    79,     4461,   5885,   14554,  1958,   8681,   1662,   2403,   75306,  168893, 14703,   9903,
    13630,  3041,   9606,   11911,  1653,   3106,   2871,   26403,  34685,  4438,   3625,   222,    4729,    52387,
    1585,   3817,   5878,   3106,   29194,  5634,   38939,  6257,   8070,   1763,   12962,  16482,  2035,    917,
    497,    66,     1881,   2913,   12659,  777,    15,     8565,   8511,   1273,   64605,  563,    1479,    975,
    186,    677,    23739,  14423,  890,    45721,  34403,  9275,   301,    2933,   9695,   71546,  1155,    6147,
    31918,  1153,   31609,  9507,   1803,   4303,   14033,  5539,   3870,   5523,   17051,  4178,   4306,    19467,
    9154,   489,    9045,   5759,   113165, 11089,  47,     2669,   5457,   9197,   2030,   358,    18263,   9263,
    3975,   16451,  10349,  1489,   6009,   367,    5771,   20419,  181,    3023,   17411,  3206,   25839,   40913,
    20013,  3642,   2114,   254,    1718,   17647,  1819,   3101,   1426,   15089,  3335,   13577,  4513,    12706,
    12641,  1930,   2535,   3449,   3121,   12539,  14434,  9586,   4763,   1969,   31981,  2253,   593,     5555,
    15,     601,    2035,   80010,  13853,  30894,  5853,   8095,   2147,   97411,  1710,   2357,   157,     3554,
    1245,   103,    5734,   13301,  509,    1289,   12743,  11534,  7861,   95,     2610,   8103,   56867,   25949,
    5731,   10653,  1431,   1865,   20249,  622,    4893,   24298,  3161,   4042,   7661,   9781,   16447,   1271,
    161,    890,    1247,   2305,   55994,  5055,   4696,   3517,   971,    2445,   817,    59061,  165,     5809,
    10675,  30367,  11122,  3171,   182,    182,    14029,  4063,   28569,  177,    2527,   109431, 2577,    4231,
    2602,   2949,   6662,   2190,   55919,  11213,  806,    542,    4547,   135,    4589,   329,    8473,    60634,
    72141,  49339,  969,    1591,   2561,   2835,   8115,   19083,  12362,  5626,   5006,   32171,  615,     1121,
    68423,  12339,  31422,  3254,   1786,   14451,  2609,   37309,  429,    65113,  6457,   25214,  650,     502,
    785,    951,    50771,  57978,  64121,  19834,  2349,   35871,  11915,  174031, 5773,   1637,   13414,   1651,
    103,    2491,   8553,   3775,   8781,   21122,  22652,  637,    2321,   1759,   4579,   10461,  757,     12501,
    3390,   28559,  2259,   41938,  13821,  5138,   1730,   797,    9235,   6543,   2382,   4873,   4101,    7642,
    279,    18398,  79082,  6682,   2518,   530,    9338,   4255,   2323,   2482,   959,    1802,   28330,   3877,
    2207,   1889,   309,    12665,  8278,   3466,   317,    4773,   4101,   33855,  2843,   2750,   4101,    4067,
    24882,  8277,   1365,   219,    82,     1819,   16951,  30426,  19079,  36453,  7519,   15722,  805,     2706,
    2267,   822,    639,    4075,   1494,   14245,  10003,  22719,  2501,   3077,   1642,   506,    1505,    7365,
    11243,  15670,  5974,   4274,   4685,   3298,   14923,  21153,  38521,  17335,  1005,   7543,   32219,   15895,
    353,    3539,   1173,   2686,   1151,   2511,   8690,   229043, 377,    554,    1125,   10742,  73151,   1170,
    7511,   20739,  1971,   13959,  9851,   182,    33499,  298,    238,    6447,   635,    2810,   469,     1083,
    24939,  4199,   2254,   1042,   18217,  20375,  55,     5605,   25569,  9393,   958,    3201,   5774,    14909,
    250649, 4222,   4251,   28242,  2682,   5458,   4074,   515,    23421,  4714,   438,    2533,   5129,    4606,
    62218,  789,    53559,  3789,   3122,   954,    10309,  7614,   94,     20345,  61,     11435,  14469,   3517,
    26167,  12145,  2318,   150747, 2043,   9563,   7745,   12403,  11953,  3823,   2130,   1867,   13882,   30847,
    12458,  104270, 10581,  8133,   506,    16407,  4765,   1878,   2897,   1265,   34699,  2829,   478,     3031,
    169958, 2229,   553,    2951,   6133,   299,    933,    11838,  12894,  1309,   14658,  693,    115061,  90,
    4734,   6086,   433,    12065,  6343,   259,    339,    7601,   533,    7935,   20419,  1607,   2155,    1226,
    33051,  15263,  3191,   37225,  11774,  5945,   102341, 24746,  3530,   2958,   443,    24637,  2927,    9697,
    193,    1717,   14033,  9497,   509,    29899,  34082,  3561,   3542,   16507,  2375,   1791,   14929,   13543,
    6571,   1614,   1239,   3077,   17634,  279,    3963,   8229,   2362,   42366,  26706,  2491,   10042,   16013,
    119490, 2451,   321,    29359,  215,    4006,   13050,  1569,   1177,   8175,   1054,   12927,  2434,    20777,
    3409,   11278,  1199,   85,     165,    2774,   2581,   15586,  67,     6138,   199,    2075,   170,     2023,
    1558,   36382,  52383,  4971,   54855,  5853,   6921,   3322,   1769,   7087,   259,    6638,   44419,   113,
    1595,   874,    101157, 3342,   9410,   415,    5526,   6207,   74597,  518,    5071,   5098,   20589,   141854,
    21975,  985,    2534,   9426,   10359,  897,    100359, 27937,  32798,  18561,  4739,   2549,   4831,    14425,
    18781,  3631,   8329,   2575,   3522,   2542,   65961,  3062,   2474,   1285,   16605,  1907,   6586,    8107,
    21590,  17669,  3269,   37,     11770,  145,    9265,   6557,   1530,   2713,   6563,   9258,   334,     2055,
    2778,   5383,   573,    2937,   9478,   36381,  1507,   3575,   7778,   1463,   24189,  25382,  2817,    5337,
    433,    302,    1095,   1307,   15285,  4223,   11893,  2282,   4407,   1895,   2053,   3573,   2399,    12342,
    16582,  43578,  3765,   18843,  6073,   193,    4377,   73111,  583,    85,     4907,   1475,   355,     2874,
    17647,  2389,   5666,   7638,   7955,   4315,   255,    8174,   4185,   17250,  478,    8955,   8979,    8643,
    9885,   7025,   3162,   9510,   6639,   18465,  63,     4583,   91,     42978,  113,    11942,  152661,  638,
    74,     53749,  26637,  2193,   774,    1591,   21358,  2849,   2346,   130591, 30698,  3305,   19162,   3095,
    1085,   9175,   77089,  8003,   5481,   1383,   13205,  2435,   74,     3923,   13782,  3917,   2015,    2141,
    12187,  3105,   12123,  2510,   27299,  2046,   10635,  1021,   111,    6767,   20753,  4942,   53755,   13533,
    431,    27953,  10487,  9178,   3707,   1194,   1101,   2510,   947,    3089,   13331,  1539,   56611,   24141,
    273,    6304,   40782,  30123,  5605,   24215,  6291,   885,    10357,  5989,   1434,   278,    5487,    4383,
    9551,   3325,   5369,   4690,   3015,   822,    44970,  462,    4686,   11766,  14453,  7485,   6925,    11782,
    6958,   11258,  5485,   77,     127491, 28195,  2643,   155,    3609,   18089,  2249,   1979,   8419,    758,
    515,    5166,   19789,  4097,   455,    4825,   281,    11923,  93446,  4261,   26951,  1029,   18643,   13181,
    434145, 1133,   256163, 7217,   1774,   30501,  3278,   7065,   41983,  12363,  717,    2639,   3982,    3650,
    27598,  23,     62655,  7994,   40685,  2979,   2445,   37,     8243,   1741,   166,    16766,  6379,    2507,
    29589,  3327,   21475,  5386,   18835,  3033,   9817,   11709,  285,    28747,  42842,  431,    9246,    6655,
    4705,   16750,  39167,  4574,   61319,  13105,  45105,  9847,   774,    1942,   10295,  14599,  48238,   6435,
    14178,  15193,  843,    6185,   3149,   2597,   15627,  8285,   5315,   7053,   22106,  27406,  20562,   607,
    505,    802,    7,      1971,   100371, 11834,  2418,   10430,  869,    237,    1490,   3909,   5387,    32371,
    1897,   3947,   170118, 15847,  711,    28677,  3250,   3037,   6738,   5683,   3614,   8587,   7630,    18811,
    3279,   1899,   2759,   346,    1629,   2797,   13115,  23553,  15421,  2189,   5481,   3745,   18871,   2930,
    4599,   1797,   14654,  20122,  3439,   4141,   52893,  16850,  26306,  56649,  171005, 30675,  6487,    2223,
    24713,  870,    4611,   2182,   8354,   1126,   142,    6601,   11937,  12419,  4038,   10986,  15643,   246,
    1545,   13110,  397,    33798,  28525,  1265,   211,    12222,  1257,   745,    7095,   411,    267,     2709,
    6650,   7510,   10715,  28591,  48927,  20547,  6571,   3075,   438,    1802,   5803,   4141,   11834,   221,
    73239,  47877,  1115,   1107,   954,    8778,   2186,   390,    6727,   3283,   27827,  73386,  1095558, 5323,
    5573,   2343,   57210,  15290,  61514,  1491,   558,    1733,   56245,  170,    36589,  6866,   28793,   30953,
    4487,   701,    8605,   9693,   3785,   3237,   10434,  247,    40171,  12737,  8727,   4993,   6950,    1983,
    1541,   10297,  15351,  2055,   1486,   13321,  9946,   1214,   44333,  634,    1122,   103623, 1959,    26109,
    85,     38278,  14415,  12066,  21023,  22,     9697,   2054,   53613,  44566,  19601,  4015,   1739,    6062,
    75077,  6327,   1406,   1339,   1347,   1473,   15,     3917,   2623,   127942, 16238,  415,    61457,   7257,
    4774,   10477,  1030,   2349,   2369,   7477,   20841,  1614,   1781,   16097,  6766,   449,    26085,   7139,
    15303,  1050,   8506,   465,    15186,  4621,   12638,  3234,   13257,  5198,   24614,  7641,   7981,    3146,
    20035,  2098,   6010,   2827,   5705,   97,     1077,   369,    1230,   3414,   485,    1663,   1765,    4198,
    3731,   30315,  6615,   8875,   28630,  20847,  40583,  26753,  9403,   898,    1806,   594,    42,      1531,
    24434,  26807,  391,    422,    1025,   14126,  449,    33086,  36381,  18581,  12489,  8863,   19145,   2163,
    4179,   6975,   14706,  21155,  3899,   9670,   1201,   12838,  5691,   4193,   16733,  2013,   3426,    187,
    1087,   9170,   5774,   27859,  969,    3690,   330,    1265,   10198,  149,    1931,   1759,   485,     8139,
    5729,   2201,   1677,   6047,   11586,  43399,  51877,  2454,   3038,   2901,   1625,   7565,   2125,    4399,
    4719,   24297,  69421,  3189};

ullint mulmod( ullint i, ullint j, ullint k ) {
  ullint r = 0;
  while( j > 0 ) {
    if( j & 1 )
      r = ( r + i ) % k;
    i = ( i + i ) % k;
    j >>= 1;
  }
  return r;
}

ullint powmod2( ullint i, ullint j, ullint k ) {
  ullint r = 1;
  while( j > 0 ) {
    if( j & 1 )
      r = mulmod( r, i, k );
    i = mulmod( i, i, k );
    j >>= 1;
  }
  return r;
}

//Function: void mpz_powm_ui (mpz_t rop, const mpz_t base, unsigned long int exp, const mpz_t mod)

ullint powmod( ullint i, ullint j, ullint k ) {
  ullint result;
  mpz_t x;
  mpz_t y;
  mpz_t z;
  mpz_init_set_ui( x, i );
  mpz_init_set_ui( y, j );
  mpz_init_set_ui( z, k );
  mpz_powm_ui(y, x, j, z);
  result = mpz_get_ui( y );
  return result;
}

int miller_rabin( ullint n, int *bases, int len ) {
  int i, r, s = 0;
  ullint d = n - 1;
  while( 0 == ( d & 1 ) ) {
    ++s;
    d >>= 1;
  }
  for( i = 0; i < len; i++ ) {
    int a = bases[i];
    ullint x = powmod( a, d, n );
    if( x == 1 || x == n - 1 )
      continue;
    for( r = 0; r < s; r++ ) {
      x = powmod( x, 2, n );
      if( x == 1 )
        return 0;
      else if( x == n - 1 ) {
        a = 0;
        break;
      }
    }
    if( a )
      return 0;
  }
  return 1;
}
} // namespace sinclair

int isPrime1e15( uint32_t n ) {
  int bases[2];
  bases[0] = 2;
  bases[1] = sinclair::SPRPlookup[( int ) ( ( ( n * sinclair::multiplier ) >> 42 ) & sinclair::mask )];

  if( n == 2 || n == 3 )
    return 1;
  else if( n < 4 || ( n & 1 ) == 0 )
    return 0;
  else
    return sinclair::miller_rabin( n, bases, 2 );
}
