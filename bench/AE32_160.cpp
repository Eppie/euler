#include <cstdint>
#include <cstdlib>

namespace AE32_144_detail {
static const uint32_t arr[160] = {
    1137139, 263856,  714742,  50482,  126797,  68779,   18316,  413263,  188193,  785723, 98530,   1278333, 26885,
    948860,  749,     583414,  646162, 148800,  42312,   11375,  19874,   1156032, 74300,  141303,  21578,   81892,
    4981,    277164,  306703,  113326, 210339,  71362,   33921,  2499286, 952034,  23836,  293139,  47936,   1266903,
    211706,  93212,   25912,   194622, 16671,   424739,  5494,   35605,   1719535, 66317,  2898345, 366050,  185444,
    239578,  113751,  1488288, 123820, 122042,  82108,   234317, 87863,   151357,  30557,  196149,  60205,   326355,
    63259,   280634,  35963,   122665, 1209822, 4412,    707332, 54636,   769217,  304916, 18367,   2917,    130045,
    24127,   130968,  152886,  51060,  951594,  8716,    17815,  236009,  18600,   65523,  1346286, 130657,  64821,
    183668,  332067,  183706,  53793,  356565,  13369,   40039,  2122485, 54404,   258567, 125997,  61746,   213501,
    1216498, 4484763, 1187783, 125925, 106895,  85783,   313326, 1123899, 286261,  499058, 647957,  46197,   49425,
    45406,   1752395, 111952,  42557,  291484,  163878,  1961,   626468,  183581,  113111, 305732,  141299,  349344,
    299894,  342649,  176384,  39412,  184461,  30644,   210543, 973981,  606959,  293708, 1830652, 952546,  308512,
    7799,    393746,  597069,  37791,  2193,    1381817, 35440,  83456,   124116,  82310,  1182300, 515809,  884986,
    116907,  405996,  9400,    71930};

uint16_t hash( uint32_t n ) {
  long long t = n;
  t = ( ( t >> 16 ) ^ t ) * 0xda2e4f1;
  return t % 160;
}

bool is_SPRP( uint32_t n, uint32_t a ) {
  uint32_t d = n - 1;
  uint32_t s = __builtin_ctz( d );
  d >>= s;
  uint64_t cur = 1;
  uint64_t pw = d;
  while( pw ) {
    if( pw & 1 ) {
      cur = ( cur * a ) % n;
    }
    a = ( ( uint64_t ) a * a ) % n;
    pw >>= 1;
  }
  if( cur == 1 ) {
    return true;
  }
  for( uint32_t r = 0; r < s; r++ ) {
    if( cur == n - 1 ) {
      return true;
    }
    cur = ( cur * cur ) % n;
  }
  return false;
}
} // namespace AE32_144_detail

bool AE32_144( uint32_t n ) {
  if( n < 11 ) {
    return ( n == 2 || n == 3 || n == 5 || n == 7 ) ? true : false;
  }
  if( !( n % 2 ) || !( n % 3 ) || !( n % 5 ) || !( n % 7 ) ) {
    return false;
  }
  if( n < 121 ) {
    return true;
  }
  if( !( n % 11 ) || !( n % 13 ) || !( n % 17 ) || !( n % 19 ) || !( n % 23 ) ) {
    return false;
  }
  if( n < 841 ) {
    return true;
  }
  uint16_t h = AE32_144_detail::hash( n );
  uint32_t base = AE32_144_detail::arr[h];
  return AE32_144_detail::is_SPRP( n, base );
}
/*
#include <cstdio>

int main(){
        uint32_t result = 0;
  for( uint32_t i = 0; i < 10000000; ++i){
          if( AE32_144( i ) ) {
                  ++ result;
  }
  }
  printf("%d\n", result);
}
*/
